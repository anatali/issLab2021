	<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 90%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{
	 
    font-size: 18px;
}
k{
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>
    
<head>
   
<title>CautiousExplorerActors</title></head>
    
<body>
<div id="top">
<h1>Lab ISS | the project cautiousExplorer with Actors<font size="5"></font> </h1>
</div>  

<div class="body"> 
<h2>Introduction</h2>
This case-study deals with the design and development of proactive/reactive software systems 
based on the concept of Actor, as introduced in 
<a href="../../it.unibo.supports/userDocs/wssupportAsActorJava.html" target="web">
LabIss2021 | wshttp support with ActorBasicJava observers</a>.
 
<h2>Requirements</h2>

 
<div class="remark">
Design and build a software system that allow the robot described in 
<a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/master/it.unibo.virtualRobot2020/userDocs/VirtualRobot2021.html" target="lab"><em>VirtualRobot2021.html</em></a>
 to exibit the following behaviour:
<ul>
<li>the robot lives in a rectangular room, delimited by walls that includes one or more devices (e.g. sonar) able to detect the presence
of obstacles, including the robot itself;</li>
<li>the robot has a <ks>den</ks> for refuge, located in the position shown in the picture
<center><img src="./img/cautiousExplorer.png" alt="cautiousExplorer" width="20%" ></center></li>
<li>the robot works as an <i>explorer of the room</i>. Starting from its <ks>den</ks>,  the goal of the robot is to
create a map of the room that records the position of the fixed obstacles. 
The presence of mobile obstacles in the room is (at the moment) excluded;</li>
<li>since the robot is <i>'cautious'</i>,  it  returns immediately to the <ks>den</ks> as soon as it finds an obstacle.
It also stops for a while (e.g. 2 seconds), when it 'feels' that the sonar has detected its presence.
</li>
 
</ul>
</div>

 <h3>Delivery</h3>
The customer requires to receive at <k>12 noon on April 6</k> a file named 
<pre>
cognome_nome_cea.pdf
</pre>
including a (synthetic) description of the project  (preceded by a proper analysis of the problem)
based on components of type <a href="../../it.unibo.supports/userDocs/wssupportAsActorJava.html" target="web">ActorBasicJava</a>
and a reference to a <i>first working prototype</i> (even with limited capabilities) of the system. 
 
 <h3>Meeting</h3>
 A SPRINT-review phase with the customer is planned (via Teams) at <k>5.15 pm on April 6</k>.

<h2>Requirement analysis</h2>
 



<h2>Problem analysis (divide et impera)</h2>

<table style="width:98%">
<tbody>	
<tr>
<td style="width:60%" >
<div class="remark">
<ul>
<li>1) Exploration requires movements that must be <k>precise</k>, in order to keep a correct position in the map.</li>
</ul></div> 

Let us introuduce a 'service'  that:
 <m>
<ul>
<li>Accepts a  command <k>{"step":"350"}</k> to move ahead the robot for a given time.</li>
<li>Returns <k>{"stepDone":"ok"},</k> if the move is done with success.</li>
<li>Returns <k>{"stepFail":"<ks>DT</ks>"},</k> if the move is interrupted by an obstacle after time <ks>DT</ks>. 
In this case it moves back the robot for time <ks>DT</ks>.
</li>
</ul>
</m>
 
</td>
<td> 
<center><img src="./img/StepRobotActor.png" alt="StepRobotActor" width="100%" ></center>
</td>
</tr>


<tr>
<td>
<div class="remark">
<ul>
<li>2) Return phase : <i>turn180</i> and reverse the path </li>

</ul></div>  

</td>
<td>
 

</td>
</tr>

<tr>
<td>
<div class="remark">
<ul>
<li>3) Explore strategy:  i) spiral with 'holes' -  ii) spiral with obstacles  iii) ...</li>

</ul></div>  

</td>
<td>
<!-- <a href="../app/src/main/java/it/unibo/executor/RunawayActor.java" target="web"><ks>RunawayActor.java</ks></a> -->

</td>
</tr>


<tr> 
<td>
<div class="remark">
<ul>
<li>4) Handling the sonar : similar to stop/resume user command</li>
</ul></div>  

</td>
<td>
</td>
</tr>
</tbody>
</table>
 

 

<h2>Test plans</h2> 


<h2>Project</h2> 
 
 <table style="width:98%">
<tbody>	
<tr>
<td style="width:60%" >
<div class="remark">
<ul>
<li>1) Exploration requires movements that must be <k>precise</k>, in order to keep a correct position in the map.</li>
</ul></div> 

Let us introuduce a 'service' 
<a href="../app/src/main/java/it/unibo/executor/StepRobotActor.java" target="web"><ks>StepRobotActor.java</ks></a> that:<br/><br/>
<m>
<ul>
<li>Accepts a  command <k>{"step":"350"}</k> to move ahead the robot for a given time.</li>
<li>Returns <k>{"stepDone":"ok"},</k> if the move is done with success.</li>
<li>Returns <k>{"stepFail":"<ks>DT</ks>"},</k> if the move is interrupted by an obstacle after time <ks>DT</ks>. 
In this case it moves back the robot for time <ks>DT</ks>.
</li>
</ul>
</m>

In order to implement such a behavior, we introduce a 
<a href="../app/src/main/kotlin/executors/TimerActor.kt" target="web"><ks>TimerActor.kt</ks></a> that:<br/><br/>
<m>

<ul>
<li>Accepts a  command <k>"{\"startTimer\":\"INTERVAL\" }"</k>.</li>
<li>Sends to its 'owner' actor the answer
<k>{"endTimer":"ok" } </k> after <ks>INTERVAL</ks> msecs if not killed before</li>
<li>It does not send any message to its owner if the timer is killed 
(by the owner) before the given <ks>INTERVAL</ks> expires.  </li>
</ul>
</m>
</td>
<td>  

<a href="../app/src/main/java/it/unibo/executor/StepRobotActor.java" target="web"><ks>StepRobotActor.java</ks></a>

<br/><br/>
<center><img src="./img/StepRobotActor.png" alt="StepRobotActor" width="100%" ></center>


</td>
</tr>

<tr>

<td>
<h3>An actor that executes basic-robot moves</h3>
Let us introuduce a 'service' 
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/BasicRobotActor.kt" target="web">
<ks>BasicRobotActor.kt</ks></a> that performs a given robot-move and sends the effects to its observers. 
<br/><br/>
The robot-move command is the paylaod of a message of type
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/ApplMessage.kt" target="web">
<ks>ApplMessage.kt</ks></a>.
<br/><br/>
<center><img src="./img/BasicRobotActor.png" alt="BasicRobotActor" width="100%" ></center>  

</td>
<td>The <a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/BasicRobotActor.kt" target="web">
<ks>BasicRobotActor.kt</ks></a>:<br/><br/>
<m>
<ul>
<li>Accepts a  command <k>"start"</k> and performs some basic robot-move.</li>
<li>Accepts a message like the following
<pre>
<kc>//msg( MSGID, MSGTYPE, SENDER, RECEIVER, CONTENT, SEQNUM )</kc>
msg(robotmove,dispatch,caller,basicRobot,
     {"robotmove":"turnLeft"@ "time": 300},3)
</pre>
and performs the specified robot-move (after replacing <tt>@</tt> with ","). 
<div class="remark">
<k>Warning</k>This replacement is an horrible trick related to the very naive way to build an ApplMessage from a given string. 
We will overcome this bad situation later.
</div></li>
<li>Sends the effects of the robot-move execution to its observers as 
the paylaod of a message of type
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/ApplMessage.kt" target="web">
<ks>ApplMessage.kt</ks></a>
</li>
</ul>
</m>
</td>
</tr>





<tr>
<td>
<div class="remark">
<ul>
<li>2) Return phase : <i>turn180</i> and reverse the <k>pathTodo</k> (+ "ll")</li>

</ul></div>  

</td>
<td>
<a href="../app/src/main/java/it/unibo/executor/RunawayActor.java" target="web"><ks>RunawayActor.java</ks></a>

</td>
</tr>

<tr>
<td>
<div class="remark">
<ul>
<li>3) Explore strategy :  </li>

</ul></div>  

</td>
<td>
<!-- <a href="../app/src/main/java/it/unibo/executor/RunawayActor.java" target="web"><ks>RunawayActor.java</ks></a> -->
 
</td>
</tr>




<tr> 
<td>
<div class="remark">
<ul>
<li>4) Handling the sonar : later</li>
</ul></div>  

</td>
<td>
</td>
</tr>
</tbody>
</table>


<h2>Embedding 
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/StepRobotActor.kt" target="code">
<ks>StepRobotActor.kt</ks></a>
into a service</h2>

The <a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/StepRobotActor.kt" target="code">
<ks>StepRobotActor.kt</ks></a> is implemented in Kotlin in the project 
<a href="../../it.unibo.kotlinSupports" target="code">it.unibo.kotlinSupports</a>.
<br/> 
In order to facilitate the usage of such a component, we embed it in a 'service' that accepts messages of type
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0robot/ApplMessage.kt" target="web">
<ks>ApplMessage.kt</ks></a> sent over the TCP port <ks>8010</ks>.
<br/> 
See <a href="../../it.unibo.kotlinSupports/userDocs/wssupportAsActorKotlin.html" target="web">
<tt>LabIss2021 | wshttp support with ActorBasicKotlin observers</tt></a> in the project <a href="../../it.unibo.kotlinSupports" target="web">
<ks>it.unibo.kotlinSupports</ks></a>.
<br/> 
Let us report here some detail about its implementation.<br/><br/> 


<table style="width:98%">
<tbody>	
<tr>
<td style="width:50%" >
 
 
In project <a href="../../it.unibo.kotlinSupports" target="web">it.unibo.kotlinSupports</a>:
<ul>
<li>
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0/ActorContextTcpServer.kt" target="web">
<ks>ActorContextTcpServer.kt</ks></a><br/>
<m>
<ul>
<li>Uses a <tt>FactoryProtocol</tt> utilty that returns an object that implements the interface <tt>IConnInteraction</tt>.
</li>
</ul>


<h4>The <tt>unibonoawtsupports</tt> </h4>
 
The unibo library <bc>unibonoawtsupports.jar</bc> provides a support for communications based on connection-based, 
two-way protocols such as <tt>TCP, UDP</tt>, etc. or a serial line (the case of <tt>Arduino</tt>).  

<center><img src="./img/noawtsupport.png" alt="noawtsupport" width="50%" height="40%"></center>

The library is a first step towards a  
<a href="#infras" target="code">custom infrastructure</a> and includes:
<ul>
<li>a set of specialized factories (<tt>FactoryTcpProtocol</tt>, <tt>FactoryUdpProtocol</tt>, etc.) that 
provide protocol-specific supports (sockets, datagrams etc);  </li>
<li> the factory <bc>FactoryProtocol</bc> that hides  details related to the specific protocol.
Each operation of the factory returns an object that implements the interface <bc>IConnInteraction</bc> 
(defined in the custom library <bc>uniboInterfaces.jar</bc>) 
that can be used to send/receive information on the connection.

<pre>
public interface IConnInteraction {
    void sendALine(String s) throws Exception;
    String receiveALine() throws Exception;
    void closeConnection() throws Exception;
}
</pre>
</m>
</td>
<td>
 <center><img src="./img/StepRobotServiceZooming.png" alt="StepRobotServiceZooming" width="100%" ></center>
  <br/><br/>
 In project <a href="../../it.unibo.kotlinSupports" target="web">it.unibo.kotlinSupports</a>:
 

<ul>
<li><a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0/ActorBasicContextKb.kt" target="web">
<ks>ActorBasicContextKb.kt</ks></a>
<m>
<ul>
<li>Stores knowledge about actors ruuning in the local node</li>
</ul></m>
</li>

<li>
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/supports/IssWsHttpKotlinSupport.kt" target="web">
<ks>IssWsHttpKotlinSupport.kt</ks></a><br/>
<m><ul>
<li>The kotlin version of the support introduced in

<a href="../../it.unibo.boundaryWalk/app/src/main/java/it/unibo/robotSupports/IssWsSupport.java" target="web">
IssWsSupport.java</a><br/>

</li>

</ul>


</td>
</tr>

<tr>
<td><h3>WalkerPath</h3>
<div class="remark">
<ul>
<li>3) Explore strategy : let us introduce an actor that attempts to perform a given sequance of moves.  </li>
</ul></div> 
<a href="../app/src/main/java/it/unibo/stepServiceCaller/WalkerPath.java" target="web"><ks>WalkerPath.java</ks></a>:<br/>
<ul>
<li>attempts to execute a given sequence of moves (<k>pathTodo</k>)</li>
<li>if it fails, executes the Return phase</li>
</ul>
</td>
<td>
 <center><img src="./img/WalkerPathArch.png" alt="WalkerPathArch" width="100%" ></center> 
 <br/> <br/>

In project <a href="../../it.unibo.kotlinSupports" target="web">it.unibo.kotlinSupports</a>:
<ul>
<li>
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0/ApplMessage.kt" target="web"><ks>ApplMessage.kt</ks></a>
</li>
<li>
<a href="../../it.unibo.kotlinSupports/app/src/main/kotlin/it/unibo/actor0/ConnectionReader.kt" target="web"><ks>ConnectionReader.kt</ks></a>
</li>
</ul>

</td>
</tr>

 </tbody>
</table>

<h2>Sprint review: <i>Divide et impera?</i></h2>
<table style="width:98%">
<tbody>	
<tr>
<td style="width:40%" >
<h3>Step+Basic: case 0</h3>

</td>
<td>
<center><img src="./img/StepAndBasicWrong.png" alt="StepAndBasicWrong" width="50%" ></center> 

</td>
</tr>

<tr>
<td><h3>Step+Basic: case1</h3>
</td>
<td>
<center><img src="./img/StepAndBasicArch1.png" alt="StepAndBasicArch1" width="80%" ></center> 
</td>
</tr>

<tr>
<td><h3>Step+Basic: case 2</h3>
</td>
<td>
<center><img src="./img/StepAndBasicArch2.png" alt="StepAndBasicArch2" width="90%" ></center> 
</td>
</tr>


<tr>
<td><h3>Step+Basic: case 3</h3>
</td>
<td>
<center><img src="./img/BasicAndStepArch.png" alt="BasicAndStepArch" width="60%" ></center> 
</td>
</tr>
 
 
 
 </tbody>
</table>


<h2>Testing</h2> 
 

<h2>Deployment</h2> 
See <a href="../../it.unibo.kotlinSupports/userDocs/wssupportAsActorKotlin.html#deploy" target="web">
<ks>LabIss2021 | wshttp support with ActorBasicKotlin observers DEPLOY</ks></a> 
in the project <a href="../../it.unibo.kotlinSupports" target="web">
<ks>it.unibo.kotlinSupports</ks></a>
 
<h2>Maintenance</h2> 
 
<!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
 QUESTIONS:
chiarisce cosa il committente intende con 'Optionally'  
chiarisce cosa il committente intende con 'should remember' 
chiarisce cosa il committente intende con 'mental map'
definisce la user story in modo da comprendere TUTTI i requisiti (anche opzionali)
discute se sia meglio avvalersi di HTTP o delle websocket e perchè
discute se sia meglio usare il linguaggio di comando cril, aril (o altro) e perchè
discute se sia meglio muovere il robot in modo random o in modo organizzato 
discute se il ritorno alla den debba/possa avvenire senza ricalcare il percorso effettuato
presenta ogni TestPlan collegandolo ad una user story e in modo 'concreto' (non come un insieme di intenti)
propone diverse tipologie di scene/situazioni per il testing
individua e propone (motivandola) una lista di priorità per il soddisfacimento dei requisiti 
presenta una stima dei tempi di realizzazione 
presenta un elenco delle risorse che sarebbe opportuno avere e/o procurarsi
presenta una architettura di progetto
presenta dettagli di progetto che permettono una precisa implementazione da parte di chi legge
pone in evidenza le parti di funzionamento proattivo e quelle di funzionamento reattivo
ECCEDE nelle dimensioni del file (al momento > 1600Kb)


<table style="width:98%">
<tbody>	
<tr>
<td style="width:50%" >
 

</td>
<td>
</td>
</tr>
 </tbody>
</table>
-->
	      	
<br/><br/> 	
</div>  

<div style="background-color:rgba(86, 56, 253, 0.9); color:white">
By studentName email: student@studio.unibo.it  
<img src="./img/teacher.gif" alt="teacher" width="10%" height="10%">
</div> 
</body>
</html>